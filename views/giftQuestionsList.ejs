<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>GiftQuestions - Sasohae Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" />
    <link href="../public/css/styles.css" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Gaegu&family=Jua&family=Nanum+Brush+Script&family=Nanum+Pen+Script&family=Noto+Sans+KR&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"
        crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <style>
        body,
        button,
        input,
        textarea {
            font-family: 'Noto Sans KR', sans-serif;
        }

        td {
            font-size: medium;
        }

        .add {
            color: green !important;
        }

        .delete {
            color: red !important;
        }

        .button.add {
            background-color: green;
            border-color: transparent;
            color: #fff !important;
            display: inline-block;
            margin-left: auto;
            margin-top: 20px;
            margin-right: 20px;
            width: 200px;
            border-radius: inherit;
        }

        .button.add.is-outlined {
            background-color: transparent;
            border-color: orange;
            color: orange !important;
        }

        .card-body {
            text-align: center;
        }

        .dataTable-sorter {
            text-align: center;
            font-size: medium;
        }
    </style>

    <script type="text/javascript">
        // 화면 로딩되면 
        $(document).ready(function () {
            getQuestionsList()
        })

        // 선물 질문 리스트
        function getQuestionsList() {
            $("#giftQuestionsList").empty()
            $.ajax({
                type: "GET",
                url: `/api/giftQuestions`,
                data: {},
                success: function (allGiftQuestions) {
                    for (let i = 0; i < allGiftQuestions.length; i++) {
                        // 테이블에 표시
                        let htmlTemp = `<tr>
                        <td>${i+1}</td>
                        <td>${allGiftQuestions[i]["giftQuestionType"]}</td>
                        <td>${allGiftQuestions[i]["giftQuestion"]}</td>
                        <td style="cursor:pointer;"  onclick="location.href='/giftQuestions/${allGiftQuestions[i]["giftQuestion_id"]}'">상세페이지 이동</td>
                        <td><input type="button" id="delete${allGiftQuestions[i]["giftQuestion_id"]}" onClick="deleteItem(this.id)"
                        class="btn btn-outline-primary" value="삭제"></td>
                        </tr>`
                        $("#giftQuestionsList").append(htmlTemp)
                    }
                }
            })
        }

        function moveToInsert() {
            location.href = "giftQuestionsInsert";
        }

        function deleteItem(id) {
            let giftQuestion_id = id.split("delete")[1]
            if (confirm("정말로 삭제하시겠습니까?") == true) { // 확인   
            } else {
                return false;
            }
            $.ajax({
                type: "DELETE",
                url: `/api/giftQuestions/${giftQuestion_id}`,
                data: {},
                success: function (response) {                  
                        location.href = location.href
                        history.go(0);
                },
                error: function (error) {
                    alert(error.responseJSON.errorMessage)
                },
            });
        }
    </script>

</head>

<body class="sb-nav-fixed">
    <%- include('layoutHeader') %>
        <!-- side bar start -->
        <div id="layoutSidenav"></div>
        <%- include ('layoutBody') %>
            <!-- side bar end -->

            <!-- 페이지에 알맞게 수정 필요 시작 -->

            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4">
                        <h1 class="mt-4">선물 질문 관리 페이지</h1>
                        <ol class="breadcrumb mb-4">
                            <li class="breadcrumb-item active">SASOHAE GIFTS QUESTIONS</li>
                        </ol>
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="fas fa-table me-1"></i>
                                선물 질문 리스트
                            </div>
                            <button class="level-item button add" onclick="moveToInsert()"
                                style="background-color: rgb(32, 92, 4);border-color: rgb(32, 92, 4);">등록하기</button>
                            <div class="card-body">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>카테고리</th>
                                            <th>질문</th>
                                            <th>상세</th>
                                            <th>삭제</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <th>No</th>
                                            <th>카테고리</th>
                                            <th>질문</th>
                                            <th>상세</th>
                                            <th>삭제</th>
                                        </tr>
                                    </tfoot>
                                    <tbody id="giftQuestionsList">
                                        <!-- db data 들어감 -->

                                        <!-- <tr>
                                            <td>1</td>
                                            <td>personality</td>
                                            <td>외향적인가요?</td>
                                            <td style="cursor:pointer;" onClick="moveToDetail()">상세페이지</td>
                                            <td><input type="button" id="delete" onClick="deleteItem()"
                                                    class="btn btn-outline-primary" value="삭제"></td>
                                        </tr>                                         -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </main>

                <!-- 페이지에 알맞게 수정 필요 끝 -->

</body>

<footer>

    <%- include ('layoutFooter') %>

</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"></script>
<script src="../public/js/scripts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="../public/assets/demo/chart-area-demo.js"></script>
<script src="../public/assets/demo/chart-bar-demo.js"></script>
<script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" crossorigin="anonymous"></script>
<script src="../public/js/datatables-simple-demo.js"></script>

</html>